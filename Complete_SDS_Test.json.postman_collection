{
	"id": "856aaa0d-d75c-2468-14a2-45fb620e331c",
	"name": "Complete_SDS_Test",
	"description": "",
	"order": [
		"7d3377e3-38da-1e34-42df-57c0d05c0de0",
		"8c0c10a4-0fd9-f0bd-0169-eae6845d34d0",
		"3727bdac-6a4b-7d63-f8a5-f53044b0b9c6",
		"7c9e66f5-a52a-537f-02f7-0e463564aca8",
		"c8a199c3-9954-43f7-59fc-b6869899d96e",
		"761d581e-0519-1c46-cfe9-e1bc9fa83f75",
		"956787a6-4dbb-0c78-6c87-0573d8c54ba4",
		"06b83e28-5052-ccc3-bbd1-4eaad0f146b1",
		"deec457a-6770-89e2-de1f-3329c9cb083d",
		"0f81f2ca-3674-ad62-f42e-9f4eb65782a2"
	],
	"folders": [],
	"timestamp": 1459864146876,
	"owner": "380773",
	"remoteLink": "",
	"public": false,
	"requests": [
		{
			"id": "06b83e28-5052-ccc3-bbd1-4eaad0f146b1",
			"name": "Encrypt the SDS device (CloudLink)",
			"dataMode": "raw",
			"data": [],
			"descriptionFormat": null,
			"description": "",
			"headers": "Authorization: Bearer {{token}}\nContent-Type: application/json\n",
			"method": "PUT",
			"pathVariables": {},
			"url": "https://{{clc1}}/cloudlink/rest/securevm/{{clientuuid}}/encryption/{{clientmountid}}",
			"preRequestScript": "",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\nfunction pausecomp(millis)\n {\n  var date = new Date();\n  var curDate = null;\n  do { curDate = new Date(); }\n  while(curDate-date < millis);\n}\npausecomp(environment['15000']);",
			"currentHelper": "normal",
			"helperAttributes": "{}",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"folder": null,
			"rawModeData": "{ \n\"encrypt\": \"encrypt\"\n}"
		},
		{
			"id": "0f81f2ca-3674-ad62-f42e-9f4eb65782a2",
			"headers": "Authorization: Basic OllXUnRhVzQ2TVRRMU9UZzROemMyT0RBNU16bzBZVGxsTVRsa05HWXlNR001TXpFNE5EVm1PRGMzWVRZNVpESmxNRFJqTlE=\nContent-Type: application/json\n",
			"url": "https://{{scaleio1}}:443/api/types/Sds/instances",
			"preRequestScript": "",
			"pathVariables": {},
			"method": "POST",
			"data": [],
			"dataMode": "raw",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\nvar data = JSON.parse(responseBody);\npostman.setEnvironmentVariable(\"sdsid\", data.id); ",
			"currentHelper": "basicAuth",
			"helperAttributes": "{\"id\":\"basic\",\"username\":\"\",\"password\":\"{{tokensio}}\",\"saveToRequest\":true}",
			"time": 1459864315161,
			"name": "Add encrypted SDS (ScaleIO)",
			"description": "",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"descriptionFormat": null,
			"folder": null,
			"rawModeData": "{\n    \"protectionDomainId\":\"{{protectiondomainid}}\",\"sdsIpList\":[{\"SdsIp\":{\"ip\":\"{{clientip}}\",\"role\":\"all\"}}],\n    \"deviceInfoList\":[{\"deviceName\":\"dev1\",\"devicePath\":\"{{clientencmount}}\",\"storagePoolId\":\"{{storagepoolid}}\"}],\n    \"name\":\"sds_name\"\n}"
		},
		{
			"id": "3727bdac-6a4b-7d63-f8a5-f53044b0b9c6",
			"headers": "Authorization: Basic YWRtaW46W29iamVjdCBPYmplY3RdLFtvYmplY3QgT2JqZWN0XSxbb2JqZWN0IE9iamVjdF0=\n",
			"url": "https://{{scaleio1}}:443/api/types/StoragePool/instances",
			"preRequestScript": "",
			"pathVariables": {},
			"method": "GET",
			"data": [],
			"dataMode": "params",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\nvar data = JSON.parse(responseBody);\npostman.setEnvironmentVariable(\"storagepoolid\", data[0].id); \n//for now this assumes 1 protection domain! Need to update this ASAP",
			"currentHelper": "basicAuth",
			"helperAttributes": "{\"id\":\"basic\",\"username\":\"admin\",\"password\":\"{{tokensio}}\",\"saveToRequest\":true}",
			"name": "Get Storage Pool ID (ScaleIO)",
			"description": "",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"rawModeData": null,
			"descriptionFormat": null,
			"folder": null
		},
		{
			"id": "761d581e-0519-1c46-cfe9-e1bc9fa83f75",
			"name": "Login as API User (CloudLink)",
			"dataMode": "params",
			"data": [],
			"rawModeData": null,
			"descriptionFormat": "html",
			"description": "",
			"headers": "",
			"method": "POST",
			"pathVariables": {},
			"url": "https://{{clc1}}/cloudlink/oauth/token?grant_type=client_credentials&client_id={{apiuser}}&client_secret={{apipwd}}&scope=all",
			"preRequestScript": "",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\ntests[\"body contains authenticated\"] = responseBody.has(\"bearer\");\nvar data = JSON.parse(responseBody);\npostman.setEnvironmentVariable(\"token\", data.access_token); ",
			"currentHelper": "normal",
			"helperAttributes": "{}",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"folder": null
		},
		{
			"id": "7c9e66f5-a52a-537f-02f7-0e463564aca8",
			"headers": "",
			"url": "https://{{scaleio1}}:443/api/types/ProtectionDomain/instances",
			"preRequestScript": "",
			"pathVariables": {},
			"method": "GET",
			"data": [],
			"dataMode": "params",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\nvar data = JSON.parse(responseBody);\npostman.setEnvironmentVariable(\"protectiondomainid\", data[0].id); \n//for now this assumes 1 protection domain! Need to update this ASAP",
			"currentHelper": "basicAuth",
			"helperAttributes": "{\"id\":\"basic\",\"username\":\"admin\",\"password\":\"{{tokensio}}\",\"saveToRequest\":true}",
			"name": "Get Protection Domains (ScaleIO)",
			"description": "",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"rawModeData": null,
			"descriptionFormat": null,
			"folder": null
		},
		{
			"id": "7d3377e3-38da-1e34-42df-57c0d05c0de0",
			"headers": "Authorization: Basic YWRtaW46dHNGdDQ1dHE0JA==\n",
			"url": "https://{{scaleio1}}:443/api/login",
			"pathVariables": {},
			"preRequestScript": "",
			"method": "GET",
			"data": [],
			"dataMode": "params",
			"name": "Initial admin Login (ScaleIO)",
			"description": "",
			"descriptionFormat": "html",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\n\nvar data = JSON.parse(responseBody);\npostman.setEnvironmentVariable(\"tokensio\", data); ",
			"currentHelper": "basicAuth",
			"helperAttributes": "{\"id\":\"basic\",\"username\":\"admin\",\"password\":\"{{scaleioadminpwd}}\",\"saveToRequest\":true}",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"rawModeData": null,
			"folder": null
		},
		{
			"id": "8c0c10a4-0fd9-f0bd-0169-eae6845d34d0",
			"headers": "Authorization: Basic YWRtaW46WVdSdGFXNDZNVFExT1RnNU5qYzBPVGswTWpvNE5qTmtZVFppTXpabE1qZGtaRE00TUdRNFpESmtaRE5tTkdReE16TmhaUQ==\n",
			"url": "https://{{scaleio1}}:443/api/types/Sds/instances",
			"preRequestScript": "",
			"pathVariables": {},
			"method": "GET",
			"data": [],
			"dataMode": "params",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\n",
			"currentHelper": "basicAuth",
			"helperAttributes": "{\"id\":\"basic\",\"username\":\"admin\",\"password\":\"{{tokensio}}\",\"saveToRequest\":true}",
			"name": "Get SDS list (ScaleIO)",
			"description": "",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"rawModeData": null,
			"descriptionFormat": null,
			"folder": null
		},
		{
			"id": "956787a6-4dbb-0c78-6c87-0573d8c54ba4",
			"name": "Get ID info (CloudLink)",
			"dataMode": "params",
			"data": [
				{
					"key": "product",
					"value": "vm",
					"type": "text",
					"enabled": true
				},
				{
					"key": "file",
					"value": {
						"0": {
							"name": "perpetual_100tib_demo.lic",
							"lastModified": 1458741297148,
							"lastModifiedDate": "2016-03-23T13:54:57.148Z",
							"webkitRelativePath": "",
							"size": 175,
							"type": ""
						},
						"length": 1
					},
					"type": "file",
					"enabled": true
				}
			],
			"rawModeData": null,
			"descriptionFormat": null,
			"description": "",
			"headers": "Authorization: Bearer {{token}}\n",
			"method": "GET",
			"pathVariables": {},
			"url": "https://{{clc1}}/cloudlink/rest/securevm",
			"preRequestScript": "",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\nvar parsed = JSON.parse(responseBody);\n\n//Currently only stores/uses one valid mount\nfor (var i = 0; i < parsed.length; ++i)\n                    {\n                        //var line = parsed[i].name + '(' + parsed[i].uuid + ') ' + parsed[i].status;\n                        for (var j = 0; j < parsed[i].resources.length; ++j)\n                        {\n              /* If the device has /dev/sd in the name then save the details*/\n              var mount = parsed[i].resources[j].mpoint;\n              var myindex = mount.indexOf('/dev/sd')\n              if (myindex >= 0 ){\n                  postman.setEnvironmentVariable(\"clientuuid\", parsed[i].uuid);\n                                postman.setEnvironmentVariable(\"clientmount\", parsed[i].resources[j].mpoint);\n                                postman.setEnvironmentVariable(\"clientmountid\", parsed[i].resources[j].id)\n              }\n            }  \n                    }\n\n\n\n\n\n;",
			"currentHelper": "normal",
			"helperAttributes": "{}",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"folder": null
		},
		{
			"id": "c8a199c3-9954-43f7-59fc-b6869899d96e",
			"name": "Remove SDS Device (ScaleIO)",
			"dataMode": "raw",
			"data": [],
			"descriptionFormat": null,
			"description": "",
			"headers": "Content-Type: application/json\nAuthorization: Basic YWRtaW46WVdSdGFXNDZNVFExT1RnNU56ZzRNekF4TkRwaU5tVm1NVFkyWW1Sa05UQTNOVGc0WkRCallUSmhOMk5rTkROak5HWTBZZw==\n",
			"method": "POST",
			"pathVariables": {},
			"url": "https://{{scaleio1}}:443/api/instances/Sds::{{sdsid}}/action/removeSds",
			"preRequestScript": "",
			"tests": "//No tests, just try to remove if needed",
			"currentHelper": "basicAuth",
			"helperAttributes": "{\"id\":\"basic\",\"username\":\"admin\",\"password\":\"{{tokensio}}\",\"saveToRequest\":true}",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"folder": null,
			"rawModeData": "{\n    \"force\":\"TRUE\"\n}"
		},
		{
			"id": "deec457a-6770-89e2-de1f-3329c9cb083d",
			"name": "Get encrypt mount label (CloudLink)",
			"dataMode": "params",
			"data": [
				{
					"key": "product",
					"value": "vm",
					"type": "text",
					"enabled": true
				},
				{
					"key": "file",
					"value": {
						"0": {
							"name": "perpetual_100tib_demo.lic",
							"lastModified": 1458741297148,
							"lastModifiedDate": "2016-03-23T13:54:57.148Z",
							"webkitRelativePath": "",
							"size": 175,
							"type": ""
						},
						"length": 1
					},
					"type": "file",
					"enabled": true
				}
			],
			"rawModeData": null,
			"descriptionFormat": null,
			"description": "",
			"headers": "Authorization: Bearer {{token}}\n",
			"method": "GET",
			"pathVariables": {},
			"url": "https://{{clc1}}/cloudlink/rest/securevm",
			"preRequestScript": "",
			"tests": "tests[\"response code is 200\"] = responseCode.code === 200;\nvar parsed = JSON.parse(responseBody);\n postman.setEnvironmentVariable(\"encryptiondone\", \"False\");\n//Currently only stores/uses one valid mount\nfor (var i = 0; i < parsed.length; ++i)\n                    {\n                        for (var j = 0; j < parsed[i].resources.length; ++j)\n                        {\n                          /* If the label has /dev/mapper in the name then save the details*/\n                          var mount = parsed[i].resources[j].label;\n                          var myindex = mount.indexOf('/dev/mapper')\n                          if (myindex >= 0 ){\n                                            postman.setEnvironmentVariable(\"clientencmount\", parsed[i].resources[j].label);\n                          }\n                          if (parsed[i].resources[j].state === \"encrypted\"){\n                              postman.setEnvironmentVariable(\"encryptiondone\", \"True\");\n                          }\n                        }\n                    }",
			"currentHelper": "normal",
			"helperAttributes": "{}",
			"collectionId": "856aaa0d-d75c-2468-14a2-45fb620e331c",
			"folder": null
		}
	]
}